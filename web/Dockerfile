FROM node:12-alpine as base
RUN npm install -g serve
WORKDIR /code
COPY package.json yarn.lock /code/
RUN yarn install --frozen-lockfile
COPY ./ /code/

FROM base as dev
CMD ["yarn", "start"]

FROM base as prod
EXPOSE 80
RUN yarn build
CMD ["serve", "--single", "build", "--listen", "80"]
